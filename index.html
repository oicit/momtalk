<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>å¤å¨å¤·å¤§å²›å¤§å†’é™©</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link href="https://fonts.googleapis.com/css2?family=Nunito:wght@400;700;800&family=Noto+Sans+SC:wght@400;700;900&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="https://unpkg.com/leaflet@1.9.4/dist/leaflet.css" />
    <script src="https://unpkg.com/leaflet@1.9.4/dist/leaflet.js"></script>
    <style>
        :root {
            --duo-green: #58cc02;
            --duo-blue: #1cb0f6;
            --duo-orange: #ff9600;
            --duo-purple: #ce82ff;
            --duo-red: #ff4b4b;
            --duo-yellow: #ffc800;
        }
        body {
            font-family: 'Nunito', 'Noto Sans SC', sans-serif;
            background-color: #f7f7f7;
            color: #4b4b4b;
            height: 100vh;
            display: flex;
            flex-direction: column;
            overflow: hidden;
        }
        .duo-card {
            border: 2px solid #e5e5e5;
            border-bottom: 6px solid #e5e5e5;
        }
        .step-circle {
            width: 65px;
            height: 55px;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            margin: 0 auto;
            border-bottom: 6px solid rgba(0,0,0,0.2);
            cursor: pointer;
            transition: all 0.3s cubic-bezier(0.34, 1.56, 0.64, 1);
        }
        .step-circle.active {
            transform: scale(1.2);
            box-shadow: 0 0 0 8px rgba(28, 176, 246, 0.2);
            border-bottom-width: 2px;
        }
        .path-line {
            width: 8px;
            background: #e5e5e5;
            margin: 0 auto;
            height: 40px;
        }
        #map { height: 100%; width: 100%; z-index: 1; border-radius: 0 0 0 20px; }
        .modal {
            display: none;
            position: fixed;
            top: 0; left: 0; width: 100%; height: 100%;
            background: rgba(0,0,0,0.6);
            z-index: 2000;
            justify-content: center;
            align-items: center;
            padding: 20px;
            backdrop-filter: blur(4px);
        }
        .custom-scroll::-webkit-scrollbar { width: 8px; }
        .custom-scroll::-webkit-scrollbar-thumb { background: #ccc; border-radius: 10px; }
        
        .day-label {
            background: white;
            border: 2px solid #e5e5e5;
            border-radius: 12px;
            padding: 4px 10px;
            font-weight: 900;
            font-size: 13px;
            color: #4b4b4b;
            text-align: center;
            box-shadow: 0 4px 6px rgba(0,0,0,0.1);
            white-space: nowrap;
        }

        .plane-marker {
            font-size: 28px;
            text-shadow: 0 2px 4px rgba(0,0,0,0.3);
            display: flex;
            align-items: center;
            justify-content: center;
        }

        .leaflet-ant-path {
            stroke-dasharray: 10, 20;
            animation: leaflet-ant-path-animation 15s linear infinite;
        }
        @keyframes leaflet-ant-path-animation {
            from { stroke-dashoffset: 100%; }
            to { stroke-dashoffset: 0%; }
        }

        .toggle-btn {
            background-color: #fff;
            border: 2px solid #e5e5e5;
            border-bottom: 4px solid #e5e5e5;
            padding: 4px 12px;
            border-radius: 12px;
            font-weight: 800;
            cursor: pointer;
            transition: all 0.1s;
        }
    </style>
</head>
<body>

    <!-- Header -->
    <nav class="bg-white border-b-2 border-gray-200 px-6 py-3 flex justify-between items-center shrink-0 z-50">
        <div class="flex items-center gap-2">
            <span class="text-3xl">ğŸŒ´</span>
            <h1 class="font-black text-xl tracking-tight text-[#58cc02]" id="nav-title">é˜¿ç½—å“ˆå¤§å†’é™©</h1>
        </div>
        <div class="flex gap-4 items-center">
            <button onclick="toggleLanguage()" class="toggle-btn" id="lang-toggle">ä¸­ / EN</button>
            <div class="w-10 h-10 rounded-full bg-blue-400 border-2 border-blue-500 overflow-hidden">
                <img src="https://api.dicebear.com/7.x/avataaars/svg?seed=Felix" alt="avatar">
            </div>
        </div>
    </nav>

    <!-- Split View -->
    <div class="flex flex-col md:flex-row flex-1 overflow-hidden">
        
        <!-- Left Side: Map -->
        <div class="w-full md:w-[70%] h-[40vh] md:h-full border-r-2 border-gray-200 relative">
            <div id="map"></div>
            
            <!-- Top Map Header -->
            <div class="absolute top-4 left-1/2 -translate-x-1/2 z-[1000] bg-white px-8 py-3 rounded-3xl duo-card w-[92%] md:w-auto shadow-xl text-center">
                <h2 class="text-lg md:text-xl font-black text-[#58cc02] leading-tight" id="map-header-title">å¤å¨å¤·å¤§å²›å¤§å†’é™©</h2>
                <p class="text-[11px] md:text-sm font-bold text-gray-600 mt-0.5" id="map-header-desc">
                    ä»çœ‹ç«å±±å£å²©æµ†åˆ°ç»ç¾æ²™æ»©å’Œæ·±é‚ƒæµ·åº•ï¼
                </p>
            </div>
        </div>

        <!-- Right Side: Timeline -->
        <div id="timelineContainer" class="w-full md:w-[30%] h-full overflow-y-auto custom-scroll bg-white p-4 md:p-6 text-center">
            <div class="max-w-[260px] mx-auto">
                <div class="mb-8 text-center">
                    <h2 class="font-black text-xl mb-1" id="timeline-title">å†’é™©è·¯å¾„</h2>
                    <p class="text-gray-400 font-extrabold uppercase tracking-widest text-[9px]">2026.02.16 - 02.21</p>
                </div>

                <div class="flex flex-col items-center gap-0 pb-32" id="path-container">
                    <!-- Path Nodes rendered by JS -->
                </div>
            </div>
        </div>
    </div>

    <!-- Modal -->
    <div id="dayModal" class="modal" onclick="closeModal(event)">
        <div class="bg-white rounded-3xl w-full max-w-2xl overflow-hidden flex flex-col max-h-[85vh] shadow-2xl" onclick="event.stopPropagation()">
            <div id="modalHeader" class="p-5 md:p-6 text-white shrink-0 relative">
                <button class="absolute top-4 right-6 text-3xl font-bold opacity-70 hover:opacity-100" onclick="closeModal()">Ã—</button>
                <div id="modalLabel" class="inline-block bg-white/20 px-3 py-1 rounded-full text-[10px] font-black mb-1 uppercase tracking-widest lang-target" data-zh="æ¢é™©ä»»åŠ¡" data-en="DAILY MISSION">æ¢é™©ä»»åŠ¡</div>
                <h2 id="modalTitle" class="text-2xl md:text-3xl font-black leading-tight"></h2>
                <p id="modalDate" class="text-base font-bold opacity-90"></p>
            </div>
            <div class="p-6 md:p-10 overflow-y-auto custom-scroll bg-[#fcfcfc] flex-1" id="modalContent"></div>
        </div>
    </div>

    <script>
        let currentLang = 'zh';

        const itinerary = {
            1: { 
                zh: { title: "æŠµè¾¾ä¸çº¢å…‰å¤œå½± ğŸŒ‹", date: "2æœˆ16æ—¥ Â· å‘¨ä¸€", timeline: "æŠµè¾¾ä¸çº¢å…‰" },
                en: { title: "Arrival & Volcano Glow ğŸŒ‹", date: "Feb 16 Â· Mon", timeline: "Arrival" },
                color: "#ff4b4b", coords: [19.43, -155.24],
                labelOffset: [75, 55], 
                events: [
                    { zh: { name: "é©¾è½¦å‰å¾€ç«å±±æ‘ (Volcano Village)", time: "13:13 é™è½", desc: "å–è½¦åé©¾è½¦çº¦2å°æ—¶ç©¿è¶Šå…¨å²›ã€‚æ²¿ Saddle Road æ¬£èµç†”å²©åœ°è²Œï¼Œè¿œçœºèŒ‚çº³å‡¯äºšã€‚ä¸­é€”åœ¨ PunaluÊ»u é»‘æ²™æ»©åœç•™ï¼Œè§‚å¯Ÿæ™’å¤ªé˜³çš„æµ·é¾Ÿï¼ˆåŠ¡å¿…éµå®ˆ3ç±³/10è‹±å°ºè·ç¦»è§„åˆ™ï¼‰ã€‚" }, en: { name: "Drive to Volcano Village", time: "1:13 PM Land", desc: "Pick up car and drive 2 hours via Saddle Road. Stop halfway at PunaluÊ»u Black Sand Beach to see turtles. Remind kids of the 10-ft (3m) distance rule." } },
                    { zh: { name: "å®‰é¡¿ä¸æ‘åº„æ™šé¤", time: "ä¸‹åˆ", desc: "å…¥ä½ç«å±±æ‘ä½å®¿ã€‚åœ¨æ‘åº„å¸‚åœºé‡‡è´­è¡¥ç»™ã€‚æ­¤åœ°æµ·æ‹”è¾ƒé«˜ä¸”åœ¨é›¨æ—åŒºï¼Œæ¯”ç§‘çº³å¯’å†·ï¼Œè¯·å‡†å¤‡å¤šå±‚è¡£ç‰©ã€‚" }, en: { name: "Settle in & Village Dinner", time: "Afternoon", desc: "Check in and stock up at Volcano Village Market. Rainforest town is coolerâ€”pack layers." } },
                    { zh: { name: "å¤œèµç«å±±å£çº¢å…‰", time: "å…¥å¤œ", desc: "è¿›å…¥å›½å®¶å…¬å›­ã€‚åœ¨ KÄ«lauea Overlookã€Wahinekapu (Steaming Bluff) æˆ– Waldron Ledge è§‚å¯Ÿ HalemaÊ»umaÊ»u ç«å±±å£çº¢å…‰ã€‚å¯é€‰ï¼šå‚åŠ â€œå…¬å›­æš—å¤œâ€æ¸¸éª‘å…µè®²åº§ã€‚" }, en: { name: "Evening Crater Glow", time: "Night", desc: "Head to viewpoints like KÄ«lauea Overlook to see the HalemaÊ»umaÊ»u glow. Check for 'After Dark in the Park' lectures." } }
                ],
                expert: { zh: "é«˜æµ·æ‹”å¤œæ™šæ°”æ¸©éª¤é™ï¼Œè¯·ä¸ºé•¿è¾ˆå’Œå­©å­å¤‡å¥½é˜²é£å¤–å¥—ã€‚æœ›è¿œé•œæ˜¯è§‚å¯Ÿç«å±±å£ç»†èŠ‚çš„ç¥å™¨ã€‚", en: "Bring binoculars for crater viewing. Pack warm layers; high elevation evenings are very chilly." }
            },
            2: { 
                zh: { title: "ç«å±±æ¢é™©è€…ä¹‹æ—¥ ğŸŒ‹", date: "2æœˆ17æ—¥ Â· å‘¨äºŒ", timeline: "ç«å±±æ·±åº¦æ¢ç´¢" },
                en: { title: "Volcano Explorer Day ğŸŒ‹", date: "Feb 17 Â· Tue", timeline: "Park Explorer" },
                color: "#ff9600", coords: [19.412, -155.245],
                labelOffset: [-15, 12],
                events: [
                    { zh: { name: "Kilauea Iki ç†”å²©æ¹–å¾’æ­¥", time: "æ—©æ™¨", desc: "æŒ‘æˆ˜ 4 è‹±é‡Œçš„ KÄ«lauea Iki ç¯çº¿ï¼Œæ¨ªè·¨å‡å›ºçš„ç†”å²©æ¹–ã€‚è¿™æ˜¯è®©å­©å­å®æ„Ÿç«å±±åŠ›é‡çš„æœ€ä½³æ–¹å¼ã€‚éšåç©¿è¿‡æ‹¥æœ‰500å¹´å†å²çš„ Thurston (NÄhuku) ç†”å²©ç®¡ã€‚" }, en: { name: "Kilauea Iki Loop", time: "AM", desc: "Hike the 4-mile loop across the hardened lava lake floor. Tangible volcanic power. Visit Thurston Lava Tube early (before 9AM)." } },
                    { zh: { name: "ç¡«ç£ºæ­¥é“ä¸è’¸æ±½å­”", time: "ä¸Šåˆ", desc: "æ¼«æ­¥ Sulphur Banks æ­¥é“ï¼ˆ1.2è‹±é‡Œï¼Œæœ¨æ¿è·¯å¯¹é•¿è¾ˆå‹å¥½ï¼‰ã€‚è§‚å¯Ÿåœ°è¡¨æ’å‡ºçš„ç«å±±æ°”ä½“ã€‚åˆé¤å¯å‰å¾€ Volcano House ä¿¯ç°ç«å±±å£ã€‚" }, en: { name: "Sulphur Banks & Steam Vents", time: "AM", desc: "Easy 1.2-mile boardwalk through volcanic gases and colorful deposits. Senior-friendly." } },
                    { zh: { name: "é“¾è·¯æ™¯è§‚è·¯ä¸çŸ³åˆ»ç¾¤", time: "ä¸‹åˆ", desc: "æ²¿ Chain of Craters Road é©±è½¦ 23 è‹±é‡Œç›´è¾¾æµ·å²¸ã€‚å¾’æ­¥è‡³ Puâ€˜uloa è§‚çœ‹ 23,000 ä¸ªå¤è€çŸ³åˆ»ã€‚åŠ¡å¿…åœç•™ ranger ç«™å®Œæˆ Junior Ranger ä»»åŠ¡é¢†å‹‹ç« ã€‚" }, en: { name: "Chain of Craters & Petroglyphs", time: "PM", desc: "Drive to the coast. Hike 0.7-mile boardwalk to Puâ€˜uloa Petroglyphs (23,000 carvings). Finish Junior Ranger booklets." } }
                ],
                alt: { zh: "å¤‡é€‰ï¼šå¦‚æœé›¨å¤§ï¼Œå¯é©±è½¦ 45 åˆ†é’Ÿå‰å¾€å¸Œæ´›è®¿é—® Ê»Imiloa å¤©æ–‡ä¸­å¿ƒï¼Œè§‚çœ‹ 120 åº§çƒå¹•å‰§åœºã€Šé©¬çº³å‡¯äºšï¼šå¤©åœ°ä¹‹é—´ã€‹ã€‚", en: "Rainy Day Alt: Drive to Hilo for Ê»Imiloa Astronomy Center and the planetarium show 'Maunakea: Between Earth and Sky'." }
            },
            3: { 
                zh: { title: "å¨å¯æ´›äºšè½¬åœºï¼šå¸Œæ´›ç§‘å­¦", date: "2æœˆ18æ—¥ Â· å‘¨ä¸‰", timeline: "å¸Œæ´›é›¨æ—ç§‘å­¦" },
                en: { title: "Transition to Waikoloa", date: "Feb 18 Â· Wed", timeline: "Hilo Science" },
                color: "#58cc02", coords: [19.724, -155.087],
                events: [
                    { zh: { name: "è·¯çº¿ Aï¼šå¸Œæ´›åŠ¨ç‰©å›­ä¸ç€‘å¸ƒ", time: "ä¸Šåˆ", desc: "è®¿é—®å¸•çº³åŸƒç“¦(PanaÊ»ewa)é›¨æ—åŠ¨ç‰©å›­ï¼ˆå…è´¹/æèµ ï¼‰ã€‚åœ¨å¸Œæ´›å¸‚åŒºçœ‹å½©è™¹ç€‘å¸ƒï¼Œéšåé©±è½¦çœ‹é˜¿å¡å¡ç€‘å¸ƒ(442è‹±å°º)ã€‚ç»ç”±å“ˆç›åº“äºšæµ·å²¸çº¿é©¾è½¦ã€‚" }, en: { name: "Route A: Hilo Zoo & Falls", time: "AM", desc: "Visit PanaÊ»ewa Zoo (only tropical zoo in US). See Rainbow Falls and Akaka Falls (442-ft drop)." } },
                    { zh: { name: "è·¯çº¿ B/Cï¼šå—éƒ¨æµ·å²¸æˆ–éå±±è·¯", time: "ä¸­åˆ", desc: "Bçº¿çœ‹é»‘æ²™æ»©æˆ– KaÊ»Å« å’–å•¡å†œåœºï¼›Cçº¿æ˜¯ç›´æ¥ç©¿è¿‡å²›ä¸­å¤®çš„ Saddle Roadã€‚æœ€ç»ˆæŠµè¾¾å¨å¯æ´›äºšå…¥ä½ Paniolo Greensã€‚" }, en: { name: "Route B/C: Coast or Saddle", time: "Noon", desc: "Route B via South Coast/Coffee farms. Route C via high-speed Saddle Road. Arrive at Waikoloa." } }
                ],
                expert: { zh: "å¸Œæ´›æ—©æ™¨å¸¸ç°å½©è™¹ï¼Œå»ºè®®æ—©ç‚¹å»ç€‘å¸ƒã€‚Paniolo Greens é™„è¿‘æœ‰è¶…å•†ï¼Œé€‚åˆé•¿ä½è¡¥ç»™ã€‚", en: "Morning visits to Rainbow Falls are best for actual rainbows. Stock up at Waikoloa markets." }
            },
            4: { 
                zh: { title: "åŒ—ç§‘å“ˆæ‹‰ï¼šç‰›ä»”ç²¾ç¥ ğŸ", date: "2æœˆ19æ—¥ Â· å‘¨å››", timeline: "ç§‘å“ˆæ‹‰ç‰›ä»”é­‚" },
                en: { title: "North Kohala Paniolo ğŸ", date: "Feb 19 Â· Thu", timeline: "Cowboy Culture" },
                color: "#ce82ff", coords: [20.02, -155.66],
                events: [
                    { zh: { name: "å¸•å…‹ç‰§åœºä¸ç‰›ä»”æ–‡åŒ–", time: "ä¸Šåˆ", desc: "åœ¨å¨ç¾äºšè‰åŸä½“éªŒ Paniolo æ–‡åŒ–ã€‚éª‘é©¬ã€å‚è§‚ç‰§åœºåšç‰©é¦†ã€‚éšåå‰å¾€å“ˆæ™®çº³ç™½æ²™æ»©æˆ– Waialea æ¹¾äº«å—æ¸©å’Œæµ·æµªã€‚" }, en: { name: "Parker Ranch & Beach", time: "AM", desc: "Experience Paniolo (cowboy) heritage. Ride horses. Relax at Hapuna or Waialea white sand beaches." } },
                    { zh: { name: "å¨å¯æ´›äºšç§‘å­¦åšç‰©é¦† (Keiki)", time: "ä¸­åˆ", desc: "Kings' Shops å†…çš„äº’åŠ¨ç§‘å­¦é¦†ï¼Œå……æ»¡åœ°è´¨ä¸æµ·æ´‹å±•å“ã€‚é—¨ç¥¨$10-$15ã€‚éšåå¾’æ­¥å¨å¯æ´›äºšçŸ³åˆ»ä¿æŠ¤åŒºã€‚" }, en: { name: "Hawaii Keiki Museum", time: "Noon", desc: "STEAM museum for kids in Waikoloa. Followed by a walk through ancient lava carvings." } },
                    { zh: { name: "åŒ—ç«¯å±±è°·ä¸å¢å¥¥ç§€", time: "ä¸‹åˆ", desc: "é©±è½¦è‡³ PololÅ« å±±è°·è§‚æ™¯ç‚¹ã€‚æ™šä¸Šå‚åŠ å¨å¯æ´›äºš Legends of Hawaiâ€˜i å¢å¥¥å¤§é¤ï¼Œè§‚çœ‹ç«åˆ€èˆå’Œä¼ è¯´è¡¨æ¼”ã€‚" }, en: { name: "PololÅ« Valley & Luau", time: "PM", desc: "PololÅ« Valley views. Evening Luau at Waikoloa with hula and fire-knife dancing." } }
                ]
            },
            5: { 
                zh: { title: "å¤§æµ·é‚€çº¦ï¼šæ·±è“æŒ‘æˆ˜ ğŸ‹", date: "2æœˆ20æ—¥ Â· å‘¨äº”", timeline: "æ·±è“å¤§æµ·é‚€çº¦" },
                en: { title: "Deep Blue Adventures ğŸ‹", date: "Feb 20 Â· Fri", timeline: "Sea Quest" },
                color: "#1cb0f6", coords: [19.64, -156.02],
                events: [
                    { zh: { name: "åº§å¤´é²¸å·…å³°è§‚èµ", time: "æ—©æ™¨", desc: "2æœˆæ˜¯è§‚é²¸å·…å³°æœŸã€‚åœ¨èˆ¹ä¸Šåˆ©ç”¨æ°´ä¸‹å¬éŸ³å™¨è†å¬é²¸é±¼ä¹‹æ­Œã€‚éšåå‚åŠ äºšç‰¹å…°è’‚æ–¯æ½œæ°´è‰‡ä¸‹æ½œ 100 è‹±å°ºï¼Œçœ‹çŠç‘šç¤å’Œæ²‰èˆ¹ã€‚" }, en: { name: "Whales & Submarine", time: "AM", desc: "Peak whale season. Listen to whale songs. Submerge 100ft in Atlantis Submarine to see reefs." } },
                    { zh: { name: "é­”é¬¼é±¼å¤œæ½œæŒ‘æˆ˜", time: "å…¥å¤œ", desc: "ç§‘çº³æ‹›ç‰Œé¡¹ç›®ï¼åœ¨æœˆäº®å’Œæµ®æ¿ç¯å…‰ä¸‹ï¼Œçœ‹æ¸©å’Œçš„é­”é¬¼é±¼åœ¨èº«ä¸‹ç¿»è…¾è¿›é£Ÿã€‚é•¿è¾ˆå¯é€‰æ‹©åœ¨èˆ¹ä¸Šè§‚å¯Ÿï¼Œæ„Ÿå®˜åŒæ ·éœ‡æ’¼ã€‚" }, en: { name: "Manta Ray Night Snorkel", time: "Night", desc: "Legendary Kona snorkel. Seniors can watch the illuminated rays safely from the boat." } },
                    { zh: { name: "é©¬çº³å‡¯äºšä¸“ä¸šè§‚æ˜Ÿ", time: "å¯é€‰", desc: "å‚åŠ ä¸“ä¸šè§‚æ˜Ÿå›¢å‰å¾€ 9200 è‹±å°ºé«˜åº¦ï¼Œåœ¨ä¸–ç•Œçº§è§‚æµ‹ç‚¹è¾¨è®¤å—å¤ªå¹³æ´‹æ˜Ÿåº§ã€‚é«˜æµ·æ‹”å¯¹è€å¹¼æœ‰æŒ‘æˆ˜ï¼Œè¯·å’¨è¯¢å‘å¯¼ã€‚" }, en: { name: "Stargazing Tour", time: "Alt", desc: "Join a narrated tour at Mauna Kea (9,200ft). World-class viewing point." } }
                ]
            },
            6: { 
                zh: { title: "æ”¶è·ä¸é“åˆ« âœˆï¸", date: "2æœˆ21æ—¥ Â· å‘¨å…­", timeline: "æ”¶è·ä¸å‘Šåˆ«" },
                en: { title: "Farewell Adventure âœˆï¸", date: "Feb 21 Â· Sat", timeline: "Farewell" },
                color: "#afafaf", coords: [19.74, -156.04],
                events: [
                    { zh: { name: "æ–‡åŒ–å·¡æ¼”ä¸é‡‡è´­", time: "ä¸Šåˆ", desc: "å‚åŠ å¡”å¸Œæèˆè¹ˆèŠ‚æˆ– SOKO è‰ºæœ¯å·¥ä½œå®¤å·¡æ¼”ã€‚æœ€åé€›å†œå¤«å¸‚åœºä¹°ç§‘çº³å’–å•¡ã€èœ‚èœœå’Œæ‰‹å·¥æœ¨é›•ä¼´æ‰‹ç¤¼ã€‚" }, en: { name: "Cultural Morn & Gifts", time: "AM", desc: "Tahitian Dance Festival or SOKO Artist tour. Farmers market for Kona coffee and honey." } },
                    { zh: { name: "èµ·é£å›ç¨‹", time: "ä¸­åˆ", desc: "11:30 æŠµè¾¾ KOA æœºåœºè¿˜è½¦ã€‚åœ¨æˆ·å¤–ç™»æœºå£äº«å—å¤å¨å¤·æœ€åçš„å¾®é£ã€‚1:58 PM èµ·é£ã€‚" }, en: { name: "Airport Departure", time: "Noon", desc: "Return car by 11:30 AM for 1:58 PM flight back to LAX. ALOHA!" } }
                ],
                expert: { zh: "åœ°è´¨å¨æˆ¿å°å®éªŒï¼šå›å®¶åå¸¦å­©å­åˆ¶ä½œç³–ç»ç’ƒâ€œç†”å²©â€ï¼Œå°†æ—…ç¨‹ä¸­çš„ç§‘å­¦çŸ¥è¯†è½¬åŒ–ä¸ºç”œèœœè®°å¿†ã€‚", en: "Geology Kitchen: Replicate lava processes at home with sugar-glass to cement learning." }
            }
        };

        const translations = {
            zh: { navTitle: "é˜¿ç½—å“ˆå¤§å†’é™©", mapHeaderTitle: "å¤å¨å¤·å¤§å²›å¤§å†’é™©", mapHeaderDesc: "ä»çœ‹ç«å±±å£å²©æµ†åˆ°ç»ç¾æ²™æ»©å’Œæ·±é‚ƒæµ·åº•ï¼", timelineTitle: "å†’é™©è·¯å¾„", langToggle: "ä¸­ / EN", coreQuest: "â­ æ ¸å¿ƒä»»åŠ¡", bonusAlt: "ğŸš€ è·¯çº¿/å¤‡é€‰", expertInsight: "ğŸ’¡ ä¸“å®¶å»ºè®®" },
            en: { navTitle: "ALOHA QUEST", mapHeaderTitle: "BIG ISLAND ADVENTURE", mapHeaderDesc: "From volcanic lava to stunning beaches & deep sea!", timelineTitle: "ADVENTURE PATH", langToggle: "EN / ä¸­", coreQuest: "â­ CORE QUESTS", bonusAlt: "ğŸš€ ROUTE / ALT", expertInsight: "ğŸ’¡ EXPERT INSIGHT" }
        };

        const map = L.map('map', { zoomControl: false }).setView([19.7, -155.5], 9);
        L.control.zoom({ position: 'bottomright' }).addTo(map);
        L.tileLayer('https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png').addTo(map);

        const planeIcon = L.divIcon({ className: 'plane-marker', html: 'âœˆï¸', iconSize: [40, 40], iconAnchor: [20, 20] });
        const airportCoords = [19.738, -156.046];
        L.marker(airportCoords, { icon: planeIcon }).addTo(map).bindTooltip("KOA");

        let markers = [], labels = [];

        function renderMapElements() {
            markers.forEach(m => map.removeLayer(m)); labels.forEach(l => map.removeLayer(l));
            markers = []; labels = [];
            Object.keys(itinerary).forEach(dayNum => {
                const d = itinerary[dayNum];
                const marker = L.circleMarker(d.coords, { color: d.color, fillColor: d.color, fillOpacity: 0.8, weight: 4, radius: 14 }).addTo(map).on('click', () => showDay(parseInt(dayNum), true));
                markers.push(marker);
                const labelIcon = L.divIcon({ className: 'custom-div-icon', html: `<div class="day-label" style="border-color:${d.color}">${currentLang === 'zh' ? 'ç¬¬' : 'Day'} ${dayNum} ${currentLang === 'zh' ? 'å¤©' : ''}</div>`, iconSize: [70, 24], iconAnchor: d.labelOffset || [30, 35] });
                const label = L.marker(d.coords, { icon: labelIcon }).addTo(map).on('click', () => showDay(parseInt(dayNum), true));
                labels.push(label);
            });
        }

        function renderTimeline() {
            const container = document.getElementById('path-container'); container.innerHTML = '';
            Object.keys(itinerary).forEach((dayNum, index) => {
                const d = itinerary[dayNum], dayData = d[currentLang];
                const node = document.createElement('div'); node.id = `node-${dayNum}`; node.className = 'text-center w-full group cursor-pointer'; node.onclick = () => showDay(parseInt(dayNum));
                node.innerHTML = `<div class="mb-2 font-black text-[#afafaf] uppercase text-[9px]">${dayData.date}</div><div class="step-circle text-white text-2xl" id="circle-${dayNum}" style="background-color: ${d.color}">${['ğŸŒ‹','ğŸ‘£','ğŸŒ¿','ğŸ','ğŸ‹','âœˆï¸'][dayNum-1]}</div><div class="font-bold mt-2 text-xs group-hover:opacity-70 transition-opacity">${dayData.timeline}</div>`;
                container.appendChild(node);
                if (index < 5) { const line = document.createElement('div'); line.className = 'path-line'; container.appendChild(line); }
            });
        }

        function toggleLanguage() {
            currentLang = currentLang === 'zh' ? 'en' : 'zh'; const t = translations[currentLang];
            document.getElementById('nav-title').innerText = t.navTitle; document.getElementById('map-header-title').innerText = t.mapHeaderTitle; document.getElementById('map-header-desc').innerText = t.mapHeaderDesc; document.getElementById('timeline-title').innerText = t.timelineTitle; document.getElementById('lang-toggle').innerText = t.langToggle;
            renderMapElements(); renderTimeline();
        }

        function showDay(dayNum, fromMap = false) {
            const data = itinerary[dayNum], dayLang = data[currentLang], modal = document.getElementById('dayModal');
            const t = translations[currentLang];
            document.querySelectorAll('.step-circle').forEach(c => c.classList.remove('active'));
            document.getElementById(`circle-${dayNum}`).classList.add('active');
            if (fromMap) document.getElementById(`node-${dayNum}`).scrollIntoView({ behavior: 'smooth', block: 'center' });
            document.getElementById('modalHeader').style.backgroundColor = data.color;
            document.getElementById('modalTitle').innerText = dayLang.title; document.getElementById('modalDate').innerText = dayLang.date;
            
            let html = `<div class="space-y-10">`;
            html += `<section><h3 class="font-black text-gray-400 text-xs uppercase tracking-widest mb-6">${t.coreQuest}</h3><div class="space-y-8">${data.events.map(e => `
                <div class="flex gap-6"><div class="w-16 h-16 bg-white duo-card rounded-2xl flex items-center justify-center shrink-0 text-3xl shadow-sm">${e.icon || 'ğŸ“'}</div><div class="pt-1"><div class="flex items-center gap-2 mb-2"><span class="bg-gray-100 text-gray-500 font-black text-[10px] px-2.5 py-1 rounded-md uppercase tracking-wide">${e[currentLang].time || ''}</span></div><h4 class="font-black text-xl md:text-2xl text-gray-800 leading-tight">${e[currentLang].name}</h4><p class="text-gray-600 text-lg md:text-xl leading-relaxed mt-2 font-bold text-justify">${e[currentLang].desc}</p></div></div>`).join('')}</div></section>`;
            
            if (data.alt) {
                html += `<section><h3 class="font-black text-blue-500 text-xs uppercase tracking-widest mb-4">${t.bonusAlt}</h3><div class="bg-blue-50 p-6 rounded-3xl border-2 border-blue-100 font-bold text-blue-700 text-lg">${data.alt[currentLang]}</div></section>`;
            }
            if (data.expert) {
                html += `<section><h3 class="font-black text-orange-500 text-xs uppercase tracking-widest mb-4">${t.expertInsight}</h3><div class="bg-orange-50 p-6 rounded-3xl border-2 border-orange-100 font-bold text-orange-700 text-lg italic">${data.expert[currentLang]}</div></section>`;
            }
            html += `</div>`;
            document.getElementById('modalContent').innerHTML = html;
            modal.style.display = 'flex'; map.flyTo(data.coords, 11.5, { duration: 1.5 });
        }

        function closeModal() { document.getElementById('dayModal').style.display = 'none'; }
        const rCoords = [airportCoords]; Object.keys(itinerary).forEach(d => rCoords.push(itinerary[d].coords)); rCoords.push(airportCoords);
        L.polyline(rCoords, { color: '#1cb0f6', weight: 5, opacity: 0.5, dashArray: '10, 10', className: 'leaflet-ant-path' }).addTo(map);
        renderMapElements(); renderTimeline();
    </script>
</body>
</html>
